<!DOCTYPE html><html lang="en"><head><link rel="icon" href="favicon.ico"><script defer="defer" src="cwqr.js"></script></head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="color-scheme" content="light dark"><title>ClassWiz QR</title><style>body{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}#app{margin:0 auto;width:100%}@media (min-width:768px){#app{width:91.666667%}}@media (min-width:1024px){#app{width:83.333333%}}@media (min-width:1280px){#app{width:66.666667%}}@media (min-width:1536px){#app{width:58.333333%}}#MathJax_Message{display:none!important}#lang{width:10%;height:1.3rem}#qrUrl{width:88%;height:1.3rem}details{margin:10px auto}details>:nth-child(2){margin:10px 15px}summary{cursor:pointer}.preview-table{border:thin solid #3883fa;border-collapse:collapse;border-spacing:0;width:100%}.preview-table td,.preview-table th{border:thin solid #3883fa;border-collapse:collapse;border-spacing:0;padding:5px 5px}.transpose tr td:first-child{font-weight:700}.fix-width .transpose tr td:first-child{text-align:center;width:2rem}.calc-result{margin:10px auto}#calc .title{font-weight:700}#calc .content{margin:10px 15px}#calc .right{text-align:right}.fix-width td{width:4rem;height:1rem}button.download{margin:10px 15px 0 15px;text-align:right}.footer{text-align:center;padding:10px;font-size:14px;color:gray}.footer a{color:gray;text-decoration:underline}@media (prefers-color-scheme:dark){svg{filter:invert(1)}}</style><script async src="https://cdn.jsdelivr.net/npm/jsoneditor@10.1.2/dist/jsoneditor-minimalist.js"></script><link href="https://cdn.jsdelivr.net/npm/jsoneditor@10.1.2/dist/jsoneditor.min.css" rel="stylesheet" type="text/css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS_CHTML"></script><div id="app"><label for="lang"></label> <select id="lang" name="lang"><option value="zh">zh</option><option value="en" selected="selected">en</option><option value="vi">vi</option></select> <label for="qrUrl"></label> <input id="qrUrl" type="search" placeholder="http://......"><details open><summary data-i18n-tag="calc-title">Calculation</summary><div id="calc"></div></details><details open><summary data-i18n-tag="basic-title">Basic Info</summary><div id="basic"></div></details><details open><summary data-i18n-tag="settings-title">Settings</summary><div id="settings"></div></details><details open><summary data-i18n-tag="qr-parse-result-title">QR Parse Result</summary><div id="qrResult"></div></details><footer class="footer"><span><svg viewBox="0 0 16 16" width="12" height="12"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></span><span><a href="https://github.com/CalcWorld/ClassWizQR" target="_blank">GitHub</a></span></footer></div><script>const lang=document.getElementById("lang"),qrUrl=document.getElementById("qrUrl");let editor;function parseOnHashChange(){qrUrl.value=location.hash.substring(1),parseQr()}function parseQr(){let t,e,n,a={},c={};qrUrl.value&&(c=cwqr.parseUrl(qrUrl.value,lang.value),({setup:t,model:e,mode:n}=c),a=JSON.parse(JSON.stringify(c))),settingsPreview(t),basicPreview(e,n),calculationPreview(c),editor.set(a),editor.expandAll()}function calculationPreview(e){const{expression:n,function:a,equation:c,result:l,matrix:i,vector:s,spreadsheet:d,statistic:o,distribution:r,variable:u,tableRange:v}=e,m=document.getElementById("calc");m.innerHTML="";let b="";b+=n?`\n<div class="calc-result" id="expression">\n    <div class="title">${t("calc-expression")}</div>\n    <div class="content">\\( ${n} \\)</div>\n</div>\n`:"",b+=a?`\n<div class="calc-result" id="function">\n    <div class="title">${t("calc-function")}</div>\n    ${a.map((t=>`<div class="content">\\( ${t.name}=${t.expression} \\)</div>`)).join("")}\n</div>\n`:"",b+=c?`\n<div class="calc-result" id="equation">\n    <div class="title">${t("calc-equation")}</div>\n    <div class="content">\\( ${c.latex} \\)</div>\n    <div class="title">${t("calc-equation-coefficient")}</div>\n    <table class="content preview-table"><tbody>\n    ${c.element.map((t=>`<tr>${t.map((t=>`<td>\\( ${t||""} \\)</td>`)).join("")}</tr>`)).join("")}\n    </tbody></table>\n</div>\n`:"";const p=(t,e,n)=>`\n<div class="calc-result" id="${e}">\n    <div class="title">${n}</div>\n    ${t.map((t=>`\n<div class="content">\\( \\mathrm{${t.name}} = ${t.latex} \\)</div>\n<table class="content preview-table"><tbody>\n${t.element.map((t=>`<tr>${t.map((t=>`<td>\\( ${t||""} \\)</td>`)).join("")}</tr>`)).join("")}\n</tbody></table>\n`)).join("")}\n</div>\n`;b+=i?p(i,"matrix",t("calc-matrix")):"",b+=s?p(s,"vector",t("calc-vector")):"",b+=d?`\n<div class="calc-result" id="spreadsheet">\n    <div class="title">${t("calc-spreadsheet")}</div>\n    <button id="spreadsheet-csv-down" class="download">${t("calc-spreadsheet-csv-down")}</button>\n    <button id="spreadsheet-csv-utf8bom-down" class="download">${t("calc-spreadsheet-csv-utf8bom-down")}</button>\n<table class="content preview-table fix-width"><thead>\n  <tr>\n    ${["","A","B","C","D","E"].map((t=>`<th>${t}</th>`)).join("")}\n  </tr></thead><tbody class="transpose">\n${d.array.map(((t,e)=>`<tr><td>${e+1}</td>${t.map((t=>`<td>${t||""}</td>`)).join("")}</tr>`)).join("")}\n</tbody></table>\n</div>\n`:"",b+=r?`\n<div class="calc-result" id="distribution">\n    <div class="title">${t("calc-distribution")}</div>\n    <div class="content">\\( ${r.latex} \\)</div>\n</div>\n`:"",b+=o?`\n<div class="calc-result" id="statistic">\n    <div class="title">${t("calc-statistic")}</div>\n    <button id="statistic-csv-down" class="download">${t("calc-statistic-csv-down")}</button>\n<table class="content preview-table fix-width"><thead>\n  <tr>\n    <th>${["",...o.array[0]].join("</th><th>")}</th>\n  </tr></thead><tbody class="transpose">\n${o.array.slice(1).map(((t,e)=>`<tr><td>${e+1}</td>${t.map((t=>`<td>${t||""}</td>`)).join("")}</tr>`)).join("")}\n</tbody></table>\n</div>\n`:"";const g=e=>`\n<table class="content preview-table fix-width"><thead><tr>\n  <th></th>\n  <th>${t("calc-variable-latex")}</th>\n  <th>${t("calc-variable-decimal")}</th>\n</tr></thead><tbody class="transpose">\n${e.map((t=>`<tr><td>${t.name}</td><td>\\( ${t.latex} \\)</td><td>${t.decimal}</td></tr>`)).join("")}\n</tbody></table>\n`;b+=l&&l[0]?`\n<div class="calc-result" id="result">\n    <div class="title">${t("calc-result")}</div>\n    <div class="content right">\\( ${l[0].latex} \\)</div>\n    ${l.length>1?g(l.slice(1)):""}\n</div>\n`:"",b+=u?`\n<div class="calc-result" id="variable">\n    <div class="title">${t("calc-variable")}</div>\n    ${g(u)}\n</div>\n`:"",b+=v?`\n<div class="calc-result" id="table-range">\n    <div class="title">${t("calc-table-range")}</div>\n    ${g(v)}\n</div>\n`:"",m.innerHTML=b;const h=`${(new Date).getTime()}.csv`;d&&(document.getElementById("spreadsheet-csv-down").onclick=()=>download(`spreadsheet-${h}`,d.csv,"text/plain")),d&&(document.getElementById("spreadsheet-csv-utf8bom-down").onclick=()=>download(`spreadsheet-${h}`,`\ufeff${d.csv}`,"text/plain")),o&&(document.getElementById("statistic-csv-down").onclick=()=>download(`statistic-${h}`,o.csv,"text/plain")),MathJax.Hub.Queue(["Typeset",MathJax.Hub,m])}function basicPreview(e,n){document.getElementById("basic").innerHTML=e&&n?`\n<table class="preview-table">\n<tbody class="transpose">\n  <tr>\n    <td>${t("mode-main")}</td>\n    <td>${n.mainName}</td>\n  </tr>\n  <tr>\n    <td>${t("mode-sub")}</td>\n    <td>${n.subName||t("mode-na")}</td>\n  </tr>\n  <tr>\n    <td>${t("model-type")}</td>\n    <td>${e.type}</td>\n  </tr>\n  <tr>\n    <td>${t("model-key")}</td>\n    <td>${e.name}</td>\n  </tr>\n  <tr>\n    <td>${t("model-diag")}</td>\n    <td>${e.prefix}-${e.id} Ver${e.version}</td>\n  </tr>\n  <tr>\n    <td>${t("model-sn")}</td>\n    <td>${e.serialNumber}</td>\n  </tr>\n</tbody></table>\n`:""}function settingsPreview(e){document.getElementById("settings").innerHTML=e?`\n<table class="preview-table"><thead>\n  <tr>\n    <th>${t("settings-key")}</th>\n    <th>${t("settings-value")}</th>\n  </tr></thead><tbody>\n  ${e.map((t=>`<tr><td>${t.name}</td><td>${t.value}</td></tr>`)).join("")}\n</tbody></table>\n`:""}async function copyToClipboard(t){try{await navigator.clipboard.writeText(t)}catch(e){console.log(e);const n=document.createElement("textarea");n.value=t,n.style.position="fixed",n.style.opacity="0",document.body.appendChild(n),n.select();try{document.execCommand("copy")}catch(e){console.error("failed to copy"),prompt("",t)}document.body.removeChild(n)}}function elementSelection(t){if(!(t&&t instanceof HTMLElement))return;const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e)}function download(t,e,n){const a=document.createElement("a"),c=new Blob([e],{type:n});a.href=URL.createObjectURL(c),a.download=t,document.body.appendChild(a),a.click(),a.remove()}function i18n(){document.querySelectorAll("[data-i18n-tag]").forEach((e=>{const n=t(e.getAttribute("data-i18n-tag"));n&&(e.innerText=n)}))}function t(t,e){e||(e=lang.value);const n={"calc-title":"Calculation","calc-expression":"Expression","calc-function":"Function","calc-equation":"Equation","calc-equation-coefficient":"Coefficients","calc-result":"Result","calc-variable":"Variable","calc-table-range":"Table Range","calc-variable-latex":"LaTeX","calc-variable-decimal":"Decimal","calc-matrix":"Matrix Presets","calc-vector":"Vector Presets","calc-spreadsheet":"Spreadsheet","calc-spreadsheet-csv-down":"Download (.csv)","calc-spreadsheet-csv-utf8bom-down":"Download (.csv UTF-8 BOM)","calc-statistic":"Statistic","calc-statistic-csv-down":"Download (.csv)","calc-distribution":"Distribution","basic-title":"Basic Info","model-key":"Product Name","model-type":"Product Type","model-diag":"Diagnostic Info","model-sn":"Serial Number","mode-main":"Main Mode","mode-sub":"Sub Mode","mode-na":"/","settings-title":"Settings","settings-key":"Settings","settings-value":"Settings Value","qr-parse-result-title":"QR Parse Result"};return({zh:{"calc-title":"计算数据","calc-expression":"表达式","calc-function":"函数定义","calc-equation":"方程","calc-equation-coefficient":"系数","calc-result":"结果","calc-variable":"变量","calc-table-range":"表格范围","calc-variable-latex":"LaTeX","calc-variable-decimal":"数值","calc-matrix":"矩阵预设","calc-vector":"向量预设","calc-spreadsheet":"数据表格","calc-spreadsheet-csv-down":"下载 (.csv)","calc-spreadsheet-csv-utf8bom-down":"下载 (.csv UTF-8 BOM)","calc-statistic":"统计表格","calc-statistic-csv-down":"下载 (.csv)","calc-distribution":"分布计算","basic-title":"基本信息","model-key":"型号","model-type":"类型","model-diag":"自检信息","model-sn":"序列号","mode-main":"主模式","mode-sub":"子模式","mode-na":"/","settings-title":"设置","settings-key":"设置项","settings-value":"设置值","qr-parse-result-title":"QR解析数据"},en:n}[e]||n)[t]||t}lang.onchange=function(){parseQr(),localStorage.setItem("lang",lang.value),i18n()},qrUrl.onchange=qrUrl.onsubmit=function(){location.hash=`#${qrUrl.value}`,parseQr()},window.onhashchange=parseOnHashChange,window.onload=function(){const t=new URLSearchParams(window.location.search),e=t.get("lang");e&&(lang.style.display="none");"true"===t.get("embed")&&(qrUrl.style.display="none");const n={mode:"view",name:"cwqr",onEvent:async(t,e)=>{if("click"===e.type){let n;if(t.value)n=t.value;else{n=editor.get();for(const e of t.path)n=n[e];n=JSON.stringify(n,null,2)}await copyToClipboard(n),elementSelection(e.srcElement)}},mainMenuBar:!1},a=document.getElementById("qrResult");editor=new JSONEditor(a,n);const c=e||localStorage.getItem("lang")||navigator.language.substring(0,2);cwqr.availableLanguages.includes(c)&&(lang.value=c,document.querySelector("html").setAttribute("lang",c)),i18n(),parseOnHashChange()}</script></html>